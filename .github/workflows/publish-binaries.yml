name: Publish wheels and Docker images

# TODO: is it possible to run this workflow only if the check-code-quality workflow has completed successfully ?
# I've tried workflow_run but see:
# https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#workflow_run
# Note: This event will only trigger a workflow run if the workflow file is on the default branch.

# Run workflow only for new git tags (including hierarchical tags like v1.0/beta), or manually
on:
  push:
    # tags:
    #   - '**'
  workflow_dispatch:

env:
  PYTHON_VERSION: 3.11
  DOCKER_REGISTRY: ghcr.io
  DOCKER_IMAGE_NAME: ghcr.io/rs-python/rs-server # TODO: use ${{ github.repository }} in lowercase ?

jobs:

  test-pull:
    runs-on: ubuntu-latest
    container: ghcr.io/rs-python/rs-server:0.0.0.post1.dev0.93d9a1b
    steps:
      - run: pip list
