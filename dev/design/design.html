<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<title>Design &amp; concepts</title>
<style>
/*! Copyright (C) 2019, TomTom (http://tomtom.com).
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/* Extension of the AsciiDoctor CSS for AsciiDoxy.
 * Adding:
 * - Floating multipage navigation.
 */
@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";
@import "https://cdn.jsdelivr.net/gh/asciidoctor/asciidoctor@2.0/data/stylesheets/asciidoctor-default.css";

/* Multipage navigation */
div#navigation {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1000;
}
div#navigation table {
    margin-bottom: 0;
}
@media screen and (min-width: 768px) {
    body.toc2 div#navigation {
        left: 15em;
    }
    body.toc2.toc-right div#navigation {
        right: 15em;
    }
}
@media screen and (min-width: 1280px) {
    body.toc2 div#navigation {
        left: 20em;
    }
    body.toc2.toc-right div#navigation {
        right: 20em;
    }
}

</style>
</head>
<body class="article">
<div id="header">
<h1>Design &amp; concepts</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The rs-server is divided into two main elements :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the rs-server frontend</p>
</li>
<li>
<p>the rs-server backend</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The rs-server frontend is a facade for users that verify the user privileges before accessing to the services provided by the rs-server backend.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rs_server_frontend">rs-server frontend</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
TODO To Be Defined
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rs_server_backend">rs-server backend</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The rs-server backend is divided in several services.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
TODO insert a table of the service with short description and the list of functionalities
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each service provides several functionalities as https endpoints.
All services are independent of others.
Each service is provided as an independent Docker image.
Each service can be started in laptop or cluster mode (see later for more details).
Each service can handle multiple requests in parallel in cluster mode.
Services are stateless, so they can easily be scaled
and the activity be divided into the multiple instances.</p>
</div>
<div class="paragraph">
<p>All services share some common structures and mechanisms.
These common elements are provided by the rs-server-common package.</p>
</div>
<div class="sect2">
<h3 id="_sources_organisation">Sources organisation</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
TODO insert the service tree structure here
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each service has its own folder named with the service name.
This folder is a python project.
It contains the sources, tests, configuration,&#8230;&#8203; for this service.
It also contains a Dockerfile describing the service output image.
The sources of each layer are separated in a specific package.</p>
</div>
<div class="paragraph">
<p>The shared elements are provided by the rs-server-common package.
It is handled as a python project as if it is a rs-server service.</p>
</div>
</div>
<div class="sect2">
<h3 id="_services">Services</h3>
<div class="sect3">
<h4 id="_cadip_service">Cadip service</h4>
<div class="paragraph">
<p>The cadip service enables users to retrieve data from cadip stations.
Each instance of this service is started for a given station.</p>
</div>
<div class="paragraph">
<p>It provides 2 endpoints :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a search endpoint that enables to search files for a time period</p>
</li>
<li>
<p>a download endpoint that enables to download a file from its id and name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The processes are realized by a DataRetriever configured to use the EODAG provider "CADIP".</p>
</div>
<div class="sect4">
<h5 id="_configuration">Configuration</h5>
<div class="paragraph">
<p>This service uses several configurations elements :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the station to url mapping that defines the url of the cadip server for each station</p>
</li>
<li>
<p>the station handled by the instance</p>
</li>
<li>
<p>the eodag configuration used to interact with the cadip station
= Frontend service</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The frontend is a rs-service service.
It only provides REST API documentation.
It contains :
* a /doc endpoint displaying the aggregated openapi specification of all the rs-server services using SwaggerUI
* a /openapi.json displaying the same openapi specification on a json format</p>
</div>
<div class="paragraph">
<p>The openapi specification is provided by a json file.
The location of this file is configurable.
It is given by an environment variable read at the start of the service.</p>
</div>
<div class="paragraph">
<p>It contains no functional implementation of the rs-server services endpoints.
Nevertheless, the "Try it out" functionality from Swagger is working
since the rs-server is deployed with an ingres controller
that handles the redirection of the requests
to the dedicated rs-server service.</p>
</div>
<div class="paragraph">
<p>The content of the documentation is static.
It is computed during the frontend build procedure
and then integrated statically in the frontend service.
Each time a service endpoint is updated,
the frontend has to be rebuilt also
to provide an up-to-date documentation.</p>
</div>
<div class="paragraph">
<p>The openapi specification is built on the CI workflow
that build the frontend service executable.
The procedure starts all the rs-server services
and retrieve the openapi specification of each service.
Once done, it creates an aggregated specification
and store it in a file.
This file is then integrated in the docker image of the service.</p>
</div>
<div class="paragraph">
<p>The procedure uses a configuration file.
this file describes all the rs-server services
that should be integrated in the aggregated openapi specification.
Each time a new service is added, its configuration has to be added in this configuration file.</p>
</div>
<div id="navigation">
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle"><a href="../background/ci.html">Prev</a></th>
<th class="tableblock halign-center valign-middle"><a href="../../index.html">Up</a><br>
<a href="../../index.html">Home</a></th>
<th class="tableblock halign-right valign-middle"><a href="../doc-generation/description.html">Next</a></th>
</tr>
</thead>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-05-16 13:49:33 UTC
</div>
</div>
</body>
</html>